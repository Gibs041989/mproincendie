
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Compte rendu - Mproincendie</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f4f4f4; max-width: 900px; margin: auto; }
    h1 { color: #cc0000; }
    fieldset { margin-bottom: 20px; }
    legend { font-weight: bold; }
    label { display: block; margin-top: 10px; }
    input, select, textarea { width: 100%; padding: 8px; margin-top: 4px; }
    .extincteur { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; background: white; }
    button { margin-top: 20px; padding: 10px 15px; font-size: 16px; }
  </style>
</head>
<body>

  <h1>ðŸ”§ Compte Rendu de Maintenance</h1>

  <form onsubmit="event.preventDefault(); alert('Compte rendu enregistrÃ© (simulation)')">

    <fieldset>
      <legend>Client</legend>
      <label>Nom du client : <input type="text" required></label>
      <label>Adresse : <input type="text"></label>
      <label>Ville / Code Postal : <input type="text"></label>
      <label>Contact : <input type="text"></label>
      <label>TÃ©lÃ©phone : <input type="text"></label>
      <label>Email : <input type="email"></label>
    </fieldset>

    <fieldset>
      <legend>Intervention</legend>
      <label>Date : <input type="date"></label>
      <label>Technicien :
        <select id="technicienSelect"></select>
      </label>
      <label>Type d'intervention :
        <select id="prestationSelect"></select>
      </label>
    </fieldset>

    <fieldset>
      <legend>Extincteurs</legend>
      <div id="extincteurs"></div>
      <button type="button" onclick="ajouterExtincteur()">+ Ajouter un extincteur</button>
    </fieldset>

    <fieldset>
      <legend>Signatures</legend>
      <label>Client :</label>
      <input type="text" placeholder="Nom ou signature (manuel plus tard)">
      <label>Technicien :</label>
      <input type="text" placeholder="Nom ou signature (manuel plus tard)">
    </fieldset>

    <button type="submit">Valider le compte rendu</button>
    <a href="index.html" style="display:block;margin-top:20px;">â¬… Retour Ã  lâ€™accueil</a>

  </form>

  <script>
    function chargerListes() {
      const types = JSON.parse(localStorage.getItem('types') || '[]');
      const prestations = JSON.parse(localStorage.getItem('prestations') || '[]');
      const techniciens = JSON.parse(localStorage.getItem('techniciens') || '[]');

      const prestationSelect = document.getElementById('prestationSelect');
      prestations.forEach(p => {
        const opt = document.createElement('option');
        opt.value = opt.text = p;
        prestationSelect.appendChild(opt);
      });

      const technicienSelect = document.getElementById('technicienSelect');
      techniciens.forEach(t => {
        const opt = document.createElement('option');
        opt.value = opt.text = t;
        technicienSelect.appendChild(opt);
      });

      window.extincteurTypes = types;
    }

    function ajouterExtincteur() {
      const container = document.getElementById('extincteurs');
      const div = document.createElement('div');
      div.className = 'extincteur';

      const typeOptions = (window.extincteurTypes || []).map(t => '<option>' + t + '</option>').join('');

      div.innerHTML = `
        <label>NÂ° Extincteur : <input type="text" required></label>
        <label>Type :
          <select>${typeOptions}</select>
        </label>
        <label>Pression Permanente (PP) : <input type="checkbox"></label>
        <label>MillÃ©sime MES : <input type="text" placeholder="Ex: 2020"></label>
        <label>Emplacement : <input type="text"></label>
        <label>OpÃ©rations :</label>
        <div id="ops">
          ${(JSON.parse(localStorage.getItem('prestations') || '[]') || []).map(op => '<label><input type="checkbox"> ' + op + '</label>').join('')}
        </div>
        <label>Observations : <textarea rows="2"></textarea></label>
      `;
      container.appendChild(div);
    }

    chargerListes();
  </script>

</body>
</html>
