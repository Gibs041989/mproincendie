

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compte-rendu Extincteurs - MproIntervention</title>
  <style>





    body { font-family: 'Segoe UI', sans-serif; background: #f5f5f5; padding: 20px; margin-bottom: 100px; }
    h2 { color: #b30000; }
    label { display: block; font-weight: 600; margin-top: 10px; }
    input, select, textarea {
      font-size: 16px; width: 100%; padding: 8px; margin-top: 4px; border-radius: 4px; border: 1px solid #ccc; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .flex { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 8px; }
    .btn { margin-top: 20px; padding: 10px 20px; background: #0077cc; color: white; border: none; border-radius: 6px; cursor: pointer; }
    .btn:hover { background: #005fa3; }
    .extincteur-bloc { background: white; border: 1px solid #ccc; border-radius: 10px; padding: 15px; margin-bottom: 20px; }
    summary { font-weight: bold; margin-bottom: 10px; cursor: pointer; }
    .checkbox-group { background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #ccc; margin-top: 20px; }
    .nav-shortcuts { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; justify-content: center; gap: 30px; border-top: 1px solid #ccc; padding: 12px 0; font-size: 1.8rem; z-index: 999; }
    @media (max-width: 600px) {
      .grid {
        grid-template-columns: 1fr !important;
      }
    }
  

.op-item, .dc-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: #f9f9f9;
  border: 1px solid #ccc;
  border-radius: 8px;
  cursor: pointer;
  width: 100%;
  box-sizing: border-box;
}
.op-item input, .dc-item input {
  margin: 0;
}



.op-item, .dc-item {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  text-align: left;
  gap: 12px;
  padding: 12px;
  background: #f9f9f9;
  border: 1px solid #ccc;
  border-radius: 8px;
  cursor: pointer;
  width: fit-content;
  max-width: 100%;
  box-sizing: border-box;
}
.op-item input, .dc-item input {
  margin: 0;
}



.op-item, .dc-item {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  text-align: left;
  gap: 12px;
  padding: 12px;
  background: #f9f9f9;
  border: 1px solid #ccc;
  border-radius: 8px;
  cursor: pointer;
  min-width: 320px;
  max-width: 100%;
  white-space: nowrap;
  box-sizing: border-box;
}
.op-item input, .dc-item input {
  margin: 0;
}



.op-item, .dc-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  text-align: left;
  gap: 12px;
  padding: 12px;
  background: #f9f9f9;
  border: 1px solid #ccc;
  border-radius: 8px;
  cursor: pointer;
  min-width: 320px;
  max-width: 100%;
  white-space: nowrap;
  box-sizing: border-box;
}
.op-item input, .dc-item input {
  margin: 0;
}



body {
  font-size: 16px;
}
input, select, textarea {
  font-size: 1rem;
  padding: 10px;
}
button {
  font-size: 1rem;
  padding: 10px 16px;
}
label {
  font-weight: 600;
}

</style>
</head>
<body>
  <h2><span style="font-size: 1.4rem; font-weight: 700;">Compte-rendu Extincteurs</span></h2>
  <div><strong>Client :</strong> Dupont Entreprise</div>
  <div><strong>Lieu d‚Äôintervention :</strong> Site Annexe - Zone industrielle</div>
  <div style="margin-top: 30px; margin-bottom: 10px;">
    <div style="display: flex; flex-wrap: wrap; gap: 30px;">
      <div style="flex: 1; min-width: 220px;">
        <label for="date_intervention">üìÖ Date d‚Äôintervention</label>
        <input type="date" name="date_intervention" id="date_intervention" />
      </div>
      <div style="flex: 2; min-width: 220px;">
        <label for="technicien">üë®‚Äçüîß Technicien intervenant</label>
        <input type="text" name="technicien" id="technicien" placeholder="Nom et pr√©nom du technicien" />
      </div>
    </div>
  </div>

  <section id="extincteurs-container"></section>
  <div style="text-align: left; margin: 20px 0;">
    <button onclick="addExtincteur()" type="button" class="btn">‚ûï Ajouter un extincteur</button>
  </div>

  

<div class="checkbox-group" style="margin-top: 20px;">
  <h3><span style="font-size: 1.2rem; font-weight: 600;">‚úÖ Devoir de conseil</span></h3>
  <div style="display: flex; flex-direction: column; gap: 12px;">
    <label class="dc-item">Registre pr√©sent et √† jour<input type="checkbox" class="check-dc" id="dc-registre" /></label>
    <label class="dc-item">Signal√©tique √† jour<input type="checkbox" class="check-dc" id="dc-signaletique" /></label>
    <label class="dc-item">BAES pr√©sents<input type="checkbox" class="check-dc" id="dc-baes" /></label>
    <label class="dc-item">Plans de s√©curit√© pr√©sents et √† jour<input type="checkbox" class="check-dc" id="dc-plans" /></label>
  </div>
</div>

</div>


  <div style="margin-top: 20px;">
    <button class="btn" onclick="validerCompteRendu()">‚úÖ Valider le compte rendu</button>
    <button class="btn" style="background:#28a745;margin-left:10px;" onclick="window.location.href='bon.html'">‚û°Ô∏è Passer au bon d‚Äôintervention</button>
  </div>

  
<template id="extincteur-template">
  <details open class="extincteur-bloc">
    <summary style="font-weight: bold; font-size: 1.15rem;">üßØ Nouvel extincteur</summary>
    <div class="grid" style="display: flex; flex-direction: column; gap: 15px;">
      <div><label>N¬∞ extincteur</label><input class="ext-num" /></div>
      <div><label>Type d'extincteur</label><input list="types-extincteurs" class="ext-type" /></div>
      <div><label class="op-item" style="width: 100%; justify-content: space-between;">Ext. PP ?<input type="checkbox" class="ext-pp" /></label></div>
      <div><label>Fabricant</label><input list="fabricants" class="ext-fab" /></div>
      <div><label>Mill√©sime</label><input list="years-list" class="ext-year" /></div>
      <div><label>Niveau</label><input class="ext-niv" /></div>
      <div><label>Emplacement</label><input class="ext-emplacement" /></div>
    </div>

    <div style="grid-column: span 2;">
      <h4 style="font-size: 1.1rem; color: #b30000; font-weight: 600; margin-top: 20px;">Op√©rations effectu√©es</h4>
      <div class="operations-column" style="display: flex; flex-direction: column; gap: 12px; margin-top: 10px;">
        <label class="op-item">V√©rification OK<input type="checkbox" data-code="VF" id="op-vf" /></label>
        <label class="op-item">R√©vision quinquennale<input type="checkbox" data-code="RQ" id="op-rq" /></label>
        <label class="op-item">Recharg√©<input type="checkbox" data-code="RE" id="op-re" /></label>
        <label class="op-item">Mise en service<input type="checkbox" data-code="MS" id="op-ms" /></label>
        <label class="op-item">√âchange standard<input type="checkbox" data-code="ES" id="op-es" /></label>
      </div>
    </div>

    <div style="grid-column: span 2;">
      <h4 style="font-size: 1.1rem; color: #b30000; font-weight: 600; margin-top: 20px;">Observation</h4>
      <textarea rows="3"></textarea>
    </div>

    <button class="btn" type="button" onclick="validerExtincteur(this)">‚úÖ Valider extincteur</button>
  </details>
</template>


  <datalist id="types-extincteurs">
    <option value="6Kg Poudre ABC" />
    <option value="2Kg CO2" />
    <option value="9L Eau + Additif" />
  </datalist>
  <datalist id="years-list">
    <option value="2025" /><option value="2024" /><option value="2023" />
  </datalist>
  <datalist id="fabricants">
    <option value="Desautel" />
    <option value="Eurofeu" />
    <option value="Andrieu" />
  </datalist>

  <div class="nav-shortcuts">
    <a href="index.html" title="Accueil">üè†</a>
    <a href="intervention_extincteurs.html" title="Extincteurs">üßØ</a>
    <a href="intervention_ria.html" title="RIA">üöø</a>
    <a href="intervention_baes.html" title="BAES">üí°</a>
    <a href="intervention_desenfumage.html" title="D√©senfumage">üí®</a>
  </div>

  <script>
    let compteur = 1;
    function addExtincteur() {
      const container = document.getElementById("extincteurs-container");
      const template = document.getElementById("extincteur-template");
      const clone = template.content.cloneNode(true);
      clone.querySelector(".ext-num").value = compteur++;
      container.appendChild(clone);
    }

    function validerExtincteur(btn) {
      const bloc = btn.closest("details");
      const num = bloc.querySelector(".ext-num").value.trim();
      const type = bloc.querySelector(".ext-type").value.trim();
      const fab = bloc.querySelector(".ext-fab").value.trim();
      const niv = bloc.querySelector(".ext-niv").value.trim();
      const empl = bloc.querySelector(".ext-emplacement").value.trim();
      const ops = [...bloc.querySelectorAll("input[data-code]:checked")];

      if (!num || !type || !niv || !empl || ops.length === 0) {
        alert("Merci de remplir les champs obligatoires et cocher au moins une op√©ration.");
        return;
      }

      const codeOps = ops.map(x => x.dataset.code).join(", ");
      bloc.querySelector("summary").textContent = `üßØ N¬∞${num} ‚Äì ${type} ‚Äì ${empl.slice(0, 12)} ‚Äì ${codeOps}`;
      [...bloc.querySelectorAll("input, textarea")].forEach(el => el.disabled = true);
      btn.style.display = "none";

      const bar = document.createElement("div");
      bar.innerHTML = `
        <button class="btn" onclick="toggleEdit(this)">‚úèÔ∏è Modifier</button>
        <button class="btn" style="background:#d9534f;" onclick="supprimerExtincteur(this)">üóëÔ∏è Supprimer</button>
      `;
      bloc.appendChild(bar);
      bloc.open = false;
    }

    function toggleEdit(btn) {
      const bloc = btn.closest("details");
      [...bloc.querySelectorAll("input, textarea")].forEach(el => el.disabled = false);
      bloc.querySelector("button").style.display = "inline-block";
      bloc.open = true;
    }

    function supprimerExtincteur(btn) {
      if (confirm("Confirmer la suppression de cet extincteur ?")) {
        btn.closest("details").remove();
      }
    }

    
function validerCompteRendu() {
  const extincteurs = document.querySelectorAll('.extincteur-bloc');
  if (extincteurs.length === 0) {
    alert("Vous devez renseigner au moins un extincteur pour valider le compte rendu.");
    return;
  }

  const nb = extincteurs.length;
  if (!confirm("Confirmer la validation pour " + nb + " extincteur(s) renseign√©(s) ?")) {
    return;
  }

  localStorage.removeItem("crm_extincteurs_CLIENT123");
  alert("Compte rendu valid√© !");
}


    // Sauvegarde automatique
    setInterval(() => {
      localStorage.setItem("crm_extincteurs_CLIENT123", document.getElementById("extincteurs-container").innerHTML);
    }, 10000);

    window.onload = () => {

    document.querySelectorAll('input[list]').forEach(input => {
      input.addEventListener('focus', () => {
        const listId = input.getAttribute('list');
        if (listId) {
          const datalist = document.getElementById(listId);
          if (datalist && datalist.options.length) {
            input.setAttribute('autocomplete', 'on');
          }
        }
      });
    });

      addExtincteur();
    };
  </script>
</body>
</html>
