
<!DOCTYPE html>

<html lang="fr">
<head>
<meta charset="utf-8"/>
<title>Nouveau client - Optimis√©</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<style>
    body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f5f5f5; }
    form { background: white; padding: 20px; border-radius: 10px; max-width: 700px; margin: auto; }
    h1 { color: #b30000; font-size: 1.5rem; }
    label { display: block; margin-top: 15px; font-weight: 600; }
    input, select, button {
      width: 100%; padding: 10px; font-size: 1rem; margin-top: 5px;
      border-radius: 5px; border: 1px solid #ccc; box-sizing: border-box;
    }
    .row { display: flex; flex-wrap: wrap; gap: 10px; }
    .row > div { flex: 1; min-width: 120px; }
    .adresse-intervention {
      border: 1px dashed #ccc;
      padding: 10px;
      margin-top: 15px;
      border-radius: 6px;
    }
    .small-btn {
      background: #0077cc; color: white; margin-top: 5px;
      font-size: 0.9rem; width: auto; padding: 6px 10px;
    }
  </style>
</head>
<body><div class="bg-white p-4 flex items-center justify-between shadow mb-4"><img class="h-12" src="logo-mendes.png"/></div><button class="text-sm text-blue-600 underline ml-4 mb-2" onclick="history.back()">‚Üê Retour</button>
<h1>‚ûï Nouveau client</h1>
<form onsubmit="enregistrerClient(); return false;">
<label>Nom / Raison sociale</label>
<input id="nom" required="" type="text"/>
<div class="row">
<div><label>SIRET</label><input id="siret" type="text"/></div>
<div><label>Dirigeant</label><input id="dirigeant" type="text"/></div>
</div>
<label>Adresse principale</label>
<div class="row">
<div><input id="rue" placeholder="N¬∞ et rue" type="text"/></div>
<div><input id="cp" oninput="suggestVille(this.value, 'ville')" placeholder="Code postal" type="text"/></div>
<div><input id="ville" list="villes" placeholder="Ville"/></div>
</div>
<button class="small-btn" onclick="geolocaliser('rue','cp','ville')" type="button">üìç Utiliser ma position</button>
<div class="row">
<div><label>T√©l√©phone</label><input id="telephone" type="tel"/></div>
<div><label>Email comptabilit√©</label><input id="email_compta" type="email"/></div>
<div><label>Email direction</label><input id="email_direction" type="email"/></div>
</div>
<label>Nom du contact r√©f√©rent</label>
<input id="contact" type="text"/>
<label>Adresses d‚Äôintervention</label>
<div id="adresses-intervention">
<div class="adresse-intervention">
<input class="lieu-nom" placeholder="Nom du lieu" type="text"/>
<input class="lieu-rue" placeholder="N¬∞ et rue" type="text"/>
<input class="lieu-cp" oninput="suggestVille(this.value, this.nextElementSibling.id)" placeholder="Code postal" type="text"/>
<input class="lieu-ville" id="lieu-ville-0" list="villes" placeholder="Ville"/>
<input class="lieu-contact" placeholder="Contact sur place" type="text"/>
<button class="small-btn" onclick="geolocaliserBloc(this)" type="button">üìç Utiliser ma position</button>
</div>
</div>
<button onclick="ajouterAdresse()" type="button">‚ûï Ajouter une adresse</button>
<button type="submit">‚úÖ Enregistrer client</button>
</form>
<datalist id="villes"></datalist>

<script>
function enregistrerClient() {
  const nom = document.getElementById('nom').value;
  if (nom.trim() !== "") {
    localStorage.setItem('dernier_client_cree', nom);
    window.location.href = 'intervention.html';
  } else {
    alert("Veuillez renseigner au minimum le nom du client.");
  }
}
</script><script>
function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}

document.addEventListener('DOMContentLoaded', function() {
  const fromPage = getQueryParam('from');
  const backLink = document.getElementById('dynamic-back-link');
  if (fromPage === 'clients') {
    backLink.href = 'client.html';
    backLink.textContent = '‚Üê Retour √† la liste des clients';
    backLink.style.display = 'inline-block';
  } else if (fromPage === 'intervention') {
    backLink.href = 'intervention.html';
    backLink.textContent = '‚Üê Retour √† l'intervention';
    backLink.style.display = 'inline-block';
  } else {
    backLink.style.display = 'none';
  }
});

function enregistrerClient() {
  const nom = document.getElementById('nom').value;
  const fromPage = getQueryParam('from') || 'intervention';
  if (nom.trim() !== "") {
    localStorage.setItem('dernier_client_cree', nom);
    window.location.href = fromPage + '.html';
  } else {
    alert("Veuillez renseigner au minimum le nom du client.");
  }
}
</script><script>
function enregistrerClient() {
  const nom = document.getElementById('nom').value;
  if (nom.trim() === "") {
    alert("Veuillez renseigner au minimum le nom du client.");
    return;
  }

  const confirmation = confirm("Confirmez-vous la cr√©ation de ce nouveau client ?");
  if (!confirmation) return;

  localStorage.setItem('dernier_client_cree', nom);
  alert("Client enregistr√© avec succ√®s !");
  history.back();
}
</script><script>
function enregistrerClient() {
  const nom = document.getElementById('nom').value;
  const ville = document.getElementById('ville').value;

  if (nom.trim() === "" || ville.trim() === "") {
    alert("Veuillez renseigner au minimum le nom du client ET la ville.");
    return;
  }

  const confirmation = confirm("Confirmez-vous la cr√©ation de ce nouveau client ?");
  if (!confirmation) return;

  localStorage.setItem('dernier_client_cree', nom);
  alert("Client enregistr√© avec succ√®s !");
  history.back();
}
</script></body>
</html>
